<div class="bg-white shadow sm:rounded-lg h-full">
  <div class="px-4 py-5 sm:p-6">
    <div class="flex items-center space-x-3">
      <svg class="w-7 h-7 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M3 7.5L7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5" />
      </svg>
      <h2 class="text-xl font-semibold text-gray-900">AI Model Comparison</h2>
    </div>

    <!-- Table of models -->
    <div class="mt-6 flow-root">
      <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
        <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
          <table class="min-w-full divide-y divide-gray-200">
            <thead>
              <tr>
                <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-0">Model Version</th>
                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Concordance Rate</th>
                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Stability Score</th>
                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Total Runs</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 bg-white">
              @for(model of allModels(); track model.id) {
                <tr class="hover:bg-gray-50">
                  <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-0">{{ model.version }}</td>
                  <td class="whitespace-nowrap px-3 py-4 text-sm font-semibold text-green-600">{{ model.concordance | number:'1.1-1' }}%</td>
                  <td class="whitespace-nowrap px-3 py-4 text-sm font-semibold text-blue-600">{{ model.stabilityScore | number:'1.2-2' }}</td>
                  <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">{{ model.totalRuns | number }}</td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <!-- Comparison Chart -->
    <div class="mt-8 border-t border-gray-200 pt-6">
      <div class="flex items-start">
        <!-- Model Selector -->
        <div class="w-1/4 pr-4">
          <div class="flex items-center justify-between">
            <h4 class="text-sm font-medium text-gray-800">Select Models</h4>
            <div>
              <button (click)="selectAll()" class="text-xs font-semibold text-blue-600 hover:underline">All</button>
              <span class="mx-1 text-xs text-gray-400">/</span>
              <button (click)="selectNone()" class="text-xs font-semibold text-blue-600 hover:underline">None</button>
            </div>
          </div>
          <fieldset class="mt-2 space-y-2">
            @for(model of allModels(); track model.id) {
              <div class="relative flex items-start">
                <div class="flex h-6 items-center">
                  <input [id]="'model-select-' + model.id" type="checkbox" 
                         [checked]="selectedModels().has(model.id)"
                         (change)="toggleModel(model.id, $event)"
                         class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-600">
                </div>
                <div class="ml-3 text-sm leading-6 flex items-center">
                  <div class="w-3 h-3 rounded-full mr-2" [style.background-color]="colorScale(model.id)"></div>
                  <label [for]="'model-select-' + model.id" class="font-medium text-gray-700 cursor-pointer">{{ model.version }}</label>
                </div>
              </div>
            }
          </fieldset>
        </div>
        <!-- D3 Chart -->
        <div class="w-3/4">
          <div #chart class="w-full h-[300px]"></div>
        </div>
      </div>
    </div>

  </div>
</div>